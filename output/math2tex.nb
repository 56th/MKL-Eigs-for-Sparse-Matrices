(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32624,        742]
NotebookOptionsPosition[     30335,        703]
NotebookOutlinePosition[     30669,        718]
CellTagsIndexPosition[     30626,        715]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Testing inf-sup constants for surface Stokes", "Title",
 CellChangeTimes->{{3.756407805308054*^9, 
  3.7564078204882708`*^9}},ExpressionUUID->"6193ad47-c70e-4e74-9d60-\
feaf6a874117"],

Cell[CellGroupData[{

Cell["Convert separate blocks (from drops) to a single mtx", "Section",
 CellChangeTimes->{{3.757442646644053*^9, 
  3.757442700626652*^9}},ExpressionUUID->"3608f823-93f6-4ce7-a043-\
78027be50adb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756407865606924*^9, 3.7564078806462517`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4af98514-6d1e-47d4-ac70-2586f4a120fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surface", "=", "\"\<torus\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FE", "=", "\"\<P2P1\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.833332", ",", "0.416666", ",", "0.208333", ",", "0.104167", ",", 
     "0.052083", ",", "0.026042", ",", "0.013021"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meshLevel", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hStr", "=", 
   RowBox[{"ToString", "/@", "h"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inDir", "=", 
   RowBox[{
   "surface", "<>", "\"\</\>\"", "<>", "FE", "<>", "\"\</blocks/h=\>\"", "<>", 
    RowBox[{"hStr", "[", 
     RowBox[{"[", "meshLevel", "]"}], "]"}], "<>", "\"\<_\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inDirC", "=", 
   RowBox[{"surface", "<>", "\"\</P1P1/blocks/h=\>\"", "<>", 
    RowBox[{"hStr", "[", 
     RowBox[{"[", "meshLevel", "]"}], "]"}], "<>", "\"\<_\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oDir", "=", 
   RowBox[{"surface", "<>", "\"\</\>\"", "<>", "FE", "<>", "\"\</h=\>\"", "<>", 
    RowBox[{"hStr", "[", 
     RowBox[{"[", "meshLevel", "]"}], "]"}], "<>", "\"\<_\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.756407895530698*^9, 3.756408069555463*^9}, {
   3.756414328126375*^9, 3.756414338479122*^9}, {3.7564146358924437`*^9, 
   3.756414654456026*^9}, {3.756414724628417*^9, 3.75641479152085*^9}, {
   3.7564148400217047`*^9, 3.756414904724207*^9}, {3.7564149791967*^9, 
   3.756414983134898*^9}, {3.756415042832946*^9, 3.756415058685153*^9}, {
   3.7564817170879993`*^9, 3.7564817542974033`*^9}, {3.756482194603101*^9, 
   3.756482205975625*^9}, {3.756482530099082*^9, 3.756482535828727*^9}, {
   3.756482594780425*^9, 3.756482631061256*^9}, {3.756484173318446*^9, 
   3.7564841734503736`*^9}, {3.756484245447363*^9, 3.7564842575589457`*^9}, 
   3.7564843248519793`*^9, {3.756487219211845*^9, 3.7564872193651123`*^9}, {
   3.75648757870693*^9, 3.7564875837304363`*^9}, {3.756487775737982*^9, 
   3.756487807402938*^9}, {3.7564878384679747`*^9, 3.7564878385766706`*^9}, {
   3.756487954234725*^9, 3.756487954389176*^9}, {3.756488040046674*^9, 
   3.7564880675021553`*^9}, {3.756489563335484*^9, 3.7564895788716*^9}, {
   3.756490497276458*^9, 3.756490497913088*^9}, {3.7564906406081667`*^9, 
   3.756490641218636*^9}, {3.756490739655985*^9, 3.7564907818995047`*^9}, {
   3.756490844245116*^9, 3.756490861588945*^9}, {3.75649810397635*^9, 
   3.756498104123567*^9}, {3.756648873889987*^9, 3.756648874043791*^9}, {
   3.756648947110805*^9, 3.756648954660109*^9}, {3.756827790941307*^9, 
   3.756827791443986*^9}, {3.756835783526105*^9, 3.756835804917295*^9}, {
   3.7568358470903873`*^9, 3.7568358716893663`*^9}, {3.7568362119143057`*^9, 
   3.756836212048018*^9}, {3.7568476860700397`*^9, 3.7568476899245243`*^9}, {
   3.7569101608903112`*^9, 3.756910161052451*^9}, {3.756910217953576*^9, 
   3.756910218106771*^9}, {3.75691043377806*^9, 3.756910433881543*^9}, {
   3.756910636790112*^9, 3.756910636969542*^9}, {3.7569107350316563`*^9, 
   3.75691073515723*^9}, {3.756911065137979*^9, 3.756911065282106*^9}, {
   3.756911776722705*^9, 3.756911781971765*^9}, {3.75691185831746*^9, 
   3.75691185855198*^9}, {3.7569119632311296`*^9, 3.756911964000025*^9}, {
   3.756912201147893*^9, 3.756912201360917*^9}, {3.7569125860186653`*^9, 
   3.7569125861344023`*^9}, {3.75691332001593*^9, 3.756913336765656*^9}, {
   3.7569134074033213`*^9, 3.7569134075566797`*^9}, {3.756913582902854*^9, 
   3.7569135830618467`*^9}, {3.756914246438919*^9, 3.75691425522895*^9}, {
   3.756915141774708*^9, 3.756915141940432*^9}, {3.7569152963878307`*^9, 
   3.7569152965319967`*^9}, {3.756915603028329*^9, 3.7569156031575823`*^9}, {
   3.7569158332877827`*^9, 3.756915859213709*^9}, {3.7569159511713467`*^9, 
   3.756915951287855*^9}, {3.756916460134927*^9, 3.75691648032717*^9}, {
   3.756916522024808*^9, 3.756916522724609*^9}, {3.756916926537431*^9, 
   3.756916926643955*^9}, {3.756917523353643*^9, 3.756917523816946*^9}, {
   3.756917789089161*^9, 3.7569177891985073`*^9}, {3.756917878042067*^9, 
   3.7569178783071117`*^9}, {3.75691843523322*^9, 3.756918435382889*^9}, {
   3.7569184997573013`*^9, 3.756918515390818*^9}, {3.756918545628004*^9, 
   3.756918545855571*^9}, {3.7569185990336123`*^9, 3.756918599162245*^9}, {
   3.756918631056377*^9, 3.756918631172125*^9}, {3.756918670863513*^9, 
   3.756918671074937*^9}, {3.756919531848247*^9, 3.756919531990407*^9}, {
   3.756919989954144*^9, 3.7569199900995913`*^9}, {3.756920044795782*^9, 
   3.7569200449073353`*^9}, {3.7569201477496233`*^9, 3.756920147880303*^9}, {
   3.756921279193605*^9, 3.756921279755991*^9}, {3.7569223298019743`*^9, 
   3.756922330001999*^9}, {3.756922434948648*^9, 3.7569224404836807`*^9}, {
   3.756948561621561*^9, 3.7569485835581427`*^9}, {3.756949731945499*^9, 
   3.756949732119488*^9}, {3.756956374628282*^9, 3.7569563748645897`*^9}, {
   3.756956601056553*^9, 3.7569566012960176`*^9}, {3.7569969446200447`*^9, 
   3.756996944997674*^9}, {3.757000278246161*^9, 3.757000287088623*^9}, {
   3.75700116015947*^9, 3.757001160285122*^9}, {3.7570011996474667`*^9, 
   3.757001218505919*^9}, {3.7570014217679663`*^9, 3.7570014304342117`*^9}, {
   3.757036371013056*^9, 3.757036371215865*^9}, {3.757053958742003*^9, 
   3.7570539590870533`*^9}, {3.7570543415506067`*^9, 3.757054350598617*^9}, {
   3.757054926513381*^9, 3.757054926824003*^9}, {3.757055149810871*^9, 
   3.757055149986084*^9}, {3.75709904157225*^9, 3.757099041704637*^9}, {
   3.7571080388597717`*^9, 3.757108038952256*^9}, {3.75710812303578*^9, 
   3.757108123247878*^9}, {3.75710822090886*^9, 3.757108221047858*^9}, {
   3.757108295387107*^9, 3.757108307161276*^9}, {3.757115088454582*^9, 
   3.7571150885178003`*^9}, {3.757119833589664*^9, 3.757119849663653*^9}, {
   3.7571220593481197`*^9, 3.757122059490116*^9}, {3.757124149668569*^9, 
   3.757124161470212*^9}, {3.757125169803935*^9, 3.7571251699605827`*^9}, {
   3.7571253560557947`*^9, 3.75712535619067*^9}, {3.757125783132227*^9, 
   3.7571257832832003`*^9}, {3.757148319685974*^9, 3.75714834553533*^9}, {
   3.7571807473645697`*^9, 3.757180747480473*^9}, {3.757183696675702*^9, 
   3.757183696805859*^9}, {3.7571874793915443`*^9, 3.757187479518589*^9}, {
   3.757254967066372*^9, 3.757254967188108*^9}, {3.757256326312736*^9, 
   3.757256326460493*^9}, {3.7572583311931133`*^9, 3.757258331308446*^9}, {
   3.757259174992227*^9, 3.757259175132115*^9}, {3.757331491309774*^9, 
   3.7573314914802723`*^9}, {3.757348445947686*^9, 3.757348446071197*^9}, {
   3.757441709901001*^9, 3.7574417101204767`*^9}, {3.757442076223587*^9, 
   3.757442076288773*^9}, {3.757442227053347*^9, 3.757442235329221*^9}, {
   3.7574427365515327`*^9, 3.757442736683646*^9}, {3.7574509406719418`*^9, 
   3.757450940870577*^9}, {3.757455430609726*^9, 3.7574554308098173`*^9}, {
   3.757455517612261*^9, 3.757455533274043*^9}, {3.757459164475973*^9, 
   3.757459164624292*^9}, {3.7574593793011*^9, 3.757459379901331*^9}, {
   3.757459504858759*^9, 3.7574595057542458`*^9}, {3.757459574418537*^9, 
   3.7574595745571747`*^9}, {3.757459702159677*^9, 3.757459702415557*^9}, {
   3.757460352088565*^9, 3.757460352230647*^9}, {3.757984893768733*^9, 
   3.7579848984359913`*^9}, {3.757985080089261*^9, 3.7579851252367477`*^9}, {
   3.7579852180013733`*^9, 3.757985218156721*^9}, {3.757985407305526*^9, 
   3.7579854074246607`*^9}, {3.757987285655129*^9, 3.75798733025345*^9}, {
   3.757987812985572*^9, 3.757987813131074*^9}, {3.757987964644058*^9, 
   3.757987964796093*^9}, {3.757988015373378*^9, 3.757988015510173*^9}, {
   3.757988572670993*^9, 3.7579885728261633`*^9}, {3.758325815817727*^9, 
   3.7583258159532537`*^9}, {3.7583264053624077`*^9, 3.758326405459873*^9}, {
   3.758329957136314*^9, 3.758329957265666*^9}, {3.758782827591365*^9, 
   3.7587829082593822`*^9}, {3.7587882854924*^9, 3.758788286573785*^9}, {
   3.758788328453264*^9, 3.7587883285699663`*^9}, {3.758788644425449*^9, 
   3.758788644538975*^9}, {3.758788812984695*^9, 3.75878881312634*^9}, {
   3.75878886764706*^9, 3.75878886778944*^9}, {3.75878895860679*^9, 
   3.758788958770376*^9}, {3.7587891124931307`*^9, 3.7587891208071213`*^9}, {
   3.7587906245032454`*^9, 3.758790626546282*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"53e9fa51-4fa1-451b-ba6e-c7a198bb6d9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDir", "<>", "\"\<A.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDir", "<>", "\"\<B.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "0"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDir", "<>", "\"\<M.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["n", "A"], "=", 
   RowBox[{"Length", "@", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["n", "S"], "=", 
   RowBox[{"Length", "@", 
    SubscriptBox["M", "0"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["C", "full"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDirC", "<>", "\"\<C_full.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["C", "n"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDirC", "<>", "\"\<C_n.mtx\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.756407857635416*^9, 3.756407890801177*^9}, {
   3.756408072979414*^9, 3.756408080032325*^9}, {3.7564086238691587`*^9, 
   3.756408624783231*^9}, {3.756408689607057*^9, 3.756408692058215*^9}, {
   3.75640880851654*^9, 3.756408809632237*^9}, {3.756408863753731*^9, 
   3.756408880937994*^9}, {3.756409138258472*^9, 3.7564091426686583`*^9}, {
   3.7564137561044703`*^9, 3.7564138014243793`*^9}, {3.756481881218474*^9, 
   3.756481901645406*^9}, {3.756481996398695*^9, 3.7564819972479067`*^9}, {
   3.756482661569109*^9, 3.756482671160651*^9}, {3.756485445423623*^9, 
   3.7564854465600233`*^9}, {3.7566487790421267`*^9, 3.756648810939148*^9}, 
   3.756654132555187*^9, 3.756827782013549*^9, {3.7569484722980633`*^9, 
   3.7569485460762243`*^9}, {3.75744281093403*^9, 3.7574428121498613`*^9}, {
   3.7579849201534863`*^9, 3.757984920595707*^9}, {3.757985054603197*^9, 
   3.7579850549126177`*^9}, 3.757987844811551*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"ec752cc5-e1cb-409c-b10f-43229f1b690c"],

Cell[BoxData[
 RowBox[{"Length", "@", 
  SubscriptBox["C", "full"]}]], "Input",
 CellChangeTimes->{{3.757994120323854*^9, 3.757994131265942*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"0beb87a2-f1d0-400c-9d12-8346636cda22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["S", "0"], "=", 
   RowBox[{"B", ".", 
    RowBox[{"Inverse", "@", "A"}], ".", 
    RowBox[{"Transpose", "@", "B"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["S", "full"], "=", 
   RowBox[{
    SubscriptBox["S", "0"], "+", 
    SubscriptBox["C", "full"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["S", "n"], "=", 
   RowBox[{
    SubscriptBox["S", "0"], "+", 
    SubscriptBox["C", "n"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "full"], "=", 
   RowBox[{
    SubscriptBox["M", "0"], "+", 
    SubscriptBox["C", "full"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "n"], "=", 
   RowBox[{
    SubscriptBox["M", "0"], "+", 
    SubscriptBox["C", "n"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7574556361097507`*^9, 3.757455643555135*^9}, {
  3.757985288335371*^9, 3.7579853200853157`*^9}, {3.7579875751276693`*^9, 
  3.757987575424027*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"ba6aa0df-4e6a-471e-abf0-a71a736fa6fa"],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["S", "0"], ",", 
    SubscriptBox["M", "0"]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7579853291779003`*^9, 3.7579853437445383`*^9}, {
  3.7579875826295424`*^9, 3.7579875909043083`*^9}, {3.7587886585170727`*^9, 
  3.758788670848486*^9}, {3.758788892252268*^9, 3.758788927581642*^9}, {
  3.758788993914632*^9, 3.758788998114265*^9}, {3.758789045584646*^9, 
  3.758789047685501*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"af1cd3ba-9c25-42d2-818c-113788554582"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"lHonest", "=", 
    RowBox[{
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["S", "full"], ",", 
        SubscriptBox["M", "full"]}], "}"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ScientificForm", "[", 
        RowBox[{"#", ",", "4"}], "]"}], "&"}], "/@", 
      RowBox[{"Sort", "[", 
       RowBox[{"lHonest", ",", 
        RowBox[{
         RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}]}], "\n", 
     RowBox[{"lHack", "=", 
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalA]", "full"], ",", 
          SubscriptBox["\[ScriptCapitalM]", "full"]}], "}"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          SubscriptBox["n", "A"], "+", "1"}], ";;"}], "]"}], "]"}]}]}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScientificForm", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}], "/@", 
    RowBox[{"Sort", "[", 
     RowBox[{"lHack", ",", 
      RowBox[{
       RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.757985323400002*^9, 3.7579853239401493`*^9}, {
  3.757987571637291*^9, 3.7579875729805326`*^9}, {3.758325831849868*^9, 
  3.758325835827384*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"492a6492-cf0d-4831-916a-af36d46e82a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Export ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "1b192425-bf6d-4d75-8158-85b62004c257"],
 " table"
}], "Section",
 CellChangeTimes->{{3.757160064728466*^9, 3.757160065849066*^9}, {
  3.757455653529909*^9, 
  3.757455662745658*^9}},ExpressionUUID->"5d44e64c-df91-4bf9-801e-\
1cf33479c78d"],

Cell[BoxData[
 RowBox[{"hStr", "=", 
  RowBox[{"hStr", "[", 
   RowBox[{"[", 
    RowBox[{"3", ";;", "4"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7583258619827003`*^9, 3.758325870486299*^9}, {
   3.758329966289156*^9, 3.7583299664306087`*^9}, {3.758782930973476*^9, 
   3.758782940285617*^9}, {3.758788298248683*^9, 3.758788298426736*^9}, {
   3.758788785054225*^9, 3.758788785220993*^9}, 3.758789089216052*^9, {
   3.758790603573862*^9, 3.75879060372129*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"28794769-e2f0-4b21-b4d6-add5ab4faa70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s0", "=", 
   RowBox[{"sfull", "=", 
    RowBox[{"sn", "=", 
     RowBox[{"n", "=", 
      RowBox[{"<|", "|>"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"n", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "surface", "<>", "\"\</\>\"", "<>", "FE", "<>", "\"\</h=\>\"", "<>",
            "h", "<>", "\"\<_size.txt\>\""}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"s0", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "surface", "<>", "\"\</\>\"", "<>", "FE", "<>", "\"\</h=\>\"", "<>",
            "h", "<>", "\"\<_A_block_0.mtx.lambda.txt\>\""}], "]"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"sn", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "surface", "<>", "\"\</\>\"", "<>", "FE", "<>", "\"\</h=\>\"", "<>",
            "h", "<>", "\"\<_A_block_n.mtx.lambda.txt\>\""}], "]"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"sfull", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "surface", "<>", "\"\</\>\"", "<>", "FE", "<>", "\"\</h=\>\"", "<>",
            "h", "<>", "\"\<_A_block_full.mtx.lambda.txt\>\""}], "]"}]}]}]}], 
      "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "hStr"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.757456588123664*^9, 3.757456653583621*^9}, {
   3.757456696308577*^9, 3.7574567368228607`*^9}, {3.757456797104134*^9, 
   3.75745694445763*^9}, {3.7574569756314793`*^9, 3.757456992843491*^9}, {
   3.757457306060063*^9, 3.757457316369774*^9}, {3.757457483133505*^9, 
   3.757457492793899*^9}, {3.7574587547604103`*^9, 3.757458810502556*^9}, {
   3.7574590663901463`*^9, 3.7574590680979967`*^9}, 3.757459347015596*^9, {
   3.758782956569832*^9, 3.758782962285789*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"139a5aa6-8057-4992-a17c-9475701a6363"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<h\>\"", ",", "\"\<\!\(\*SubscriptBox[\(n\), \(A\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(n\), \(S\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", "SpanFromLeft", 
       ",", "\"\<\!\(\*SubscriptBox[\(S\), \(n\)]\)\>\"", ",", "SpanFromLeft",
        ",", "\"\<\!\(\*SubscriptBox[\(S\), \(full\)]\)\>\"", ",", 
       "SpanFromLeft"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "SpanFromAbove", ",", "SpanFromAbove", ",", "SpanFromAbove", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(min\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(min\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(min\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ScientificForm", "[", 
         RowBox[{
          RowBox[{"ToExpression", "@", "#"}], ",", "3"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nA\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nS\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"s0", "[", 
          RowBox[{"#", ",", "\"\<lambdas\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"sn", "[", 
          RowBox[{"#", ",", "\"\<lambdas\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"sfull", "[", 
          RowBox[{"#", ",", "\"\<lambdas\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "&"}], "/@", "hStr"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tableRes", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ScientificForm", "[", 
         RowBox[{
          RowBox[{"ToExpression", "@", "#"}], ",", "3"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nA\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nS\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
         RowBox[{"s0", "[", 
          RowBox[{"#", ",", "\"\<residuals\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
         RowBox[{"sn", "[", 
          RowBox[{"#", ",", "\"\<residuals\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
         RowBox[{"sfull", "[", 
          RowBox[{"#", ",", "\"\<residuals\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "&"}], "/@", "hStr"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.756415221981977*^9, 3.756415359828733*^9}, {
   3.7564154642973557`*^9, 3.7564154748828173`*^9}, {3.75641559192651*^9, 
   3.7564156391710463`*^9}, {3.756415803136593*^9, 3.756415925465226*^9}, {
   3.756415961441599*^9, 3.75641596607924*^9}, {3.756416009932086*^9, 
   3.7564161342141047`*^9}, {3.7569481937410593`*^9, 3.756948215446056*^9}, {
   3.7569483264498672`*^9, 3.756948328737749*^9}, {3.756948633115903*^9, 
   3.756948699536316*^9}, {3.756949319451996*^9, 3.756949343816921*^9}, {
   3.756949551358749*^9, 3.7569495660601807`*^9}, {3.756949719760213*^9, 
   3.7569497210199003`*^9}, {3.756949833548538*^9, 3.756949853222731*^9}, {
   3.75711959835032*^9, 3.757119608755267*^9}, {3.757148472134547*^9, 
   3.757148472309092*^9}, {3.757148586904916*^9, 3.7571485870578947`*^9}, {
   3.7571486173029423`*^9, 3.7571486174039993`*^9}, {3.7574570466091557`*^9, 
   3.757457119199337*^9}, {3.757457509200075*^9, 3.757457567959278*^9}, {
   3.757458404218047*^9, 3.7574584098068647`*^9}, 3.757458724871483*^9, {
   3.7574588334754677`*^9, 3.757458949335189*^9}, {3.757459362105814*^9, 
   3.757459363498476*^9}, {3.7574610190983477`*^9, 3.7574610618600807`*^9}, {
   3.7583258950005503`*^9, 3.758325910868505*^9}, {3.7583263378514557`*^9, 
   3.758326340185788*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"1ab55286-a91d-4364-ad7a-868886db4119"],

Cell[BoxData[{
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{"header", ",", "table"}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{"header", ",", "tableRes"}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.756415110016934*^9, 3.756415112828258*^9}, {
   3.756415478474792*^9, 3.7564154929895277`*^9}, {3.756415575079176*^9, 
   3.756415585569605*^9}, {3.756416012269113*^9, 3.756416016623958*^9}, {
   3.756416175676708*^9, 3.756416183961246*^9}, {3.7569490700328197`*^9, 
   3.756949071626814*^9}, {3.756949901426509*^9, 3.756949913776581*^9}, {
   3.757461075685412*^9, 3.757461080979609*^9}, 3.758325938983561*^9},
 CellLabel->
  "In[237]:=",ExpressionUUID->"9f4da7c1-1ed1-4f5b-8009-b43b21d3a419"],

Cell[BoxData[
 RowBox[{"<<", " ", "\"\<TeXTableForm.m\>\""}]], "Input",
 CellChangeTimes->{{3.7569504032804947`*^9, 3.756950404080031*^9}, {
  3.7569504383642597`*^9, 3.756950445149898*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[239]:=",ExpressionUUID->"b1bc8da2-3577-4048-8ddb-d316fabb8dc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TeXTableForm", "[", 
   RowBox[{"table", ",", "1", ",", 
    RowBox[{
    "\"\<LaTeX/\>\"", "<>", "surface", "<>", "\"\<_\>\"", "<>", "FE", "<>", 
     "\"\<_table.tex\>\""}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7569511669375257`*^9, 3.756951204427828*^9}, {
   3.756951302047423*^9, 3.7569513828009357`*^9}, {3.757119480155694*^9, 
   3.7571194865393267`*^9}, 3.7571196217335176`*^9, {3.758782986464807*^9, 
   3.7587830056767406`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"031db65d-2951-4047-9f06-f10b474e0608"],

Cell[BoxData[
 RowBox[{"tex", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
      "\"\<\\\\\\\\ \\hline\>\""}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
      "\"\<LaTeX/\>\"", "<>", "surface", "<>", "\"\<_\>\"", "<>", "FE", "<>", 
       "\"\<_table.tex\>\""}], ",", "\"\<Table\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.756952648255701*^9, 3.75695279004072*^9}, {
   3.7569531625351267`*^9, 3.756953251793041*^9}, {3.756953295605999*^9, 
   3.756953379971849*^9}, {3.757119645572233*^9, 3.75711964678327*^9}, 
   3.757148497936266*^9, 3.758783026045351*^9},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[241]:=",ExpressionUUID->"772672a6-1805-42f9-9868-5bfe028e5465"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<LaTeX/\>\"", "<>", "surface", "<>", "\"\<_\>\"", "<>", "FE", "<>", 
    "\"\<_table.tex\>\""}], ",", "tex", ",", "\"\<Table\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7569513875442266`*^9, 3.756951432344377*^9}, {
   3.75695147308438*^9, 3.756951567887931*^9}, {3.756951602522017*^9, 
   3.7569516633530197`*^9}, {3.756951717731988*^9, 3.756951754218623*^9}, {
   3.7569518244307537`*^9, 3.7569519100906277`*^9}, {3.756951966086198*^9, 
   3.7569519705791597`*^9}, {3.756952075204831*^9, 3.7569520767605057`*^9}, {
   3.756952109151977*^9, 3.756952110876313*^9}, {3.756952276199881*^9, 
   3.756952302563987*^9}, {3.7569533045307207`*^9, 3.7569533110890636`*^9}, {
   3.757148603232441*^9, 3.75714860432613*^9}, 3.758783053614909*^9},
 CellLabel->
  "In[242]:=",ExpressionUUID->"cb4f9bb5-e552-4b79-9ae0-2f02a2a9d7d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TeXTableForm", "[", 
   RowBox[{"tableRes", ",", "1", ",", 
    RowBox[{
    "\"\<LaTeX/\>\"", "<>", "surface", "<>", "\"\<_\>\"", "<>", "FE", "<>", 
     "\"\<_res_table.tex\>\""}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7569511669375257`*^9, 3.756951204427828*^9}, {
   3.756951302047423*^9, 3.7569513828009357`*^9}, {3.757119480155694*^9, 
   3.7571194865393267`*^9}, 3.7571196217335176`*^9, {3.758326010860011*^9, 
   3.7583260260695667`*^9}, 3.758783064890785*^9},
 CellLabel->
  "In[243]:=",ExpressionUUID->"deee8dd4-0000-49d8-907b-90081e413548"],

Cell[BoxData[
 RowBox[{"tex", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
      "\"\<\\\\\\\\ \\hline\>\""}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
      "\"\<LaTeX/\>\"", "<>", "surface", "<>", "\"\<_\>\"", "<>", "FE", "<>", 
       "\"\<_res_table.tex\>\""}], ",", "\"\<Table\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.756952648255701*^9, 3.75695279004072*^9}, {
   3.7569531625351267`*^9, 3.756953251793041*^9}, {3.756953295605999*^9, 
   3.756953379971849*^9}, {3.757119645572233*^9, 3.75711964678327*^9}, 
   3.757148497936266*^9, {3.758326054554625*^9, 3.758326055966894*^9}, 
   3.758783073176442*^9},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[244]:=",ExpressionUUID->"6a8e51e9-f84b-45e1-846b-5019ba3b9c30"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<LaTeX/\>\"", "<>", "surface", "<>", "\"\<_\>\"", "<>", "FE", "<>", 
    "\"\<_res_table.tex\>\""}], ",", "tex", ",", "\"\<Table\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7569513875442266`*^9, 3.756951432344377*^9}, {
   3.75695147308438*^9, 3.756951567887931*^9}, {3.756951602522017*^9, 
   3.7569516633530197`*^9}, {3.756951717731988*^9, 3.756951754218623*^9}, {
   3.7569518244307537`*^9, 3.7569519100906277`*^9}, {3.756951966086198*^9, 
   3.7569519705791597`*^9}, {3.756952075204831*^9, 3.7569520767605057`*^9}, {
   3.756952109151977*^9, 3.756952110876313*^9}, {3.756952276199881*^9, 
   3.756952302563987*^9}, {3.7569533045307207`*^9, 3.7569533110890636`*^9}, {
   3.757148603232441*^9, 3.75714860432613*^9}, {3.758326062257434*^9, 
   3.758326063160488*^9}, 3.758783084680831*^9},
 CellLabel->
  "In[245]:=",ExpressionUUID->"f212adfe-6af5-45fa-a517-3842a99b1702"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1853, 1025},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 189, 3, 98, "Title",ExpressionUUID->"6193ad47-c70e-4e74-9d60-feaf6a874117"],
Cell[CellGroupData[{
Cell[794, 29, 197, 3, 68, "Section",ExpressionUUID->"3608f823-93f6-4ce7-a043-78027be50adb"],
Cell[994, 34, 264, 5, 31, "Input",ExpressionUUID->"4af98514-6d1e-47d4-ac70-2586f4a120fa"],
Cell[1261, 41, 8413, 132, 250, "Input",ExpressionUUID->"53e9fa51-4fa1-451b-ba6e-c7a198bb6d9a"],
Cell[9677, 175, 2082, 51, 170, "Input",ExpressionUUID->"ec752cc5-e1cb-409c-b10f-43229f1b690c"],
Cell[11762, 228, 228, 5, 31, "Input",ExpressionUUID->"0beb87a2-f1d0-400c-9d12-8346636cda22"],
Cell[11993, 235, 1107, 35, 124, "Input",ExpressionUUID->"ba6aa0df-4e6a-471e-abf0-a71a736fa6fa"],
Cell[13103, 272, 560, 12, 31, "Input",ExpressionUUID->"af1cd3ba-9c25-42d2-818c-113788554582"],
Cell[13666, 286, 1445, 41, 101, "Input",ExpressionUUID->"492a6492-cf0d-4831-916a-af36d46e82a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15148, 332, 642, 21, 68, "Section",ExpressionUUID->"5d44e64c-df91-4bf9-801e-1cf33479c78d"],
Cell[15793, 355, 553, 11, 31, "Input",ExpressionUUID->"28794769-e2f0-4b21-b4d6-add5ab4faa70"],
Cell[16349, 368, 2418, 57, 170, "Input",ExpressionUUID->"139a5aa6-8057-4992-a17c-9475701a6363"],
Cell[18770, 427, 5228, 120, 400, "Input",ExpressionUUID->"1ab55286-a91d-4364-ad7a-868886db4119"],
Cell[24001, 549, 993, 20, 55, "Input",ExpressionUUID->"9f4da7c1-1ed1-4f5b-8009-b43b21d3a419"],
Cell[24997, 571, 303, 6, 31, "Input",ExpressionUUID->"b1bc8da2-3577-4048-8ddb-d316fabb8dc5"],
Cell[25303, 579, 567, 12, 31, "Input",ExpressionUUID->"031db65d-2951-4047-9f06-f10b474e0608"],
Cell[25873, 593, 965, 26, 31, "Input",ExpressionUUID->"772672a6-1805-42f9-9868-5bfe028e5465"],
Cell[26841, 621, 894, 16, 31, "Input",ExpressionUUID->"cb4f9bb5-e552-4b79-9ae0-2f02a2a9d7d0"],
Cell[27738, 639, 596, 12, 31, "Input",ExpressionUUID->"deee8dd4-0000-49d8-907b-90081e413548"],
Cell[28337, 653, 1019, 27, 31, "Input",ExpressionUUID->"6a8e51e9-f84b-45e1-846b-5019ba3b9c30"],
Cell[29359, 682, 948, 17, 31, "Input",ExpressionUUID->"f212adfe-6af5-45fa-a517-3842a99b1702"]
}, Open  ]]
}, Open  ]]
}
]
*)

