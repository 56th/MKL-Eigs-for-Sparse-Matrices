(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34056,        828]
NotebookOptionsPosition[     31953,        791]
NotebookOutlinePosition[     32287,        806]
CellTagsIndexPosition[     32244,        803]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Testing inf-sup constants for surface Stokes", "Title",
 CellChangeTimes->{{3.756407805308054*^9, 
  3.7564078204882708`*^9}},ExpressionUUID->"6193ad47-c70e-4e74-9d60-\
feaf6a874117"],

Cell[CellGroupData[{

Cell["Convert separate blocks (from drops) to a single mtx", "Section",
 CellChangeTimes->{{3.757442646644053*^9, 
  3.757442700626652*^9}},ExpressionUUID->"3608f823-93f6-4ce7-a043-\
78027be50adb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756407865606924*^9, 3.7564078806462517`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4af98514-6d1e-47d4-ac70-2586f4a120fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FE", "=", "\"\<P2P1\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.833332", ",", "0.416666", ",", "0.208333", ",", "0.104167", ",", 
     "0.052083", ",", "0.026042", ",", "0.013021"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meshLevel", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hStr", "=", 
   RowBox[{"ToString", "/@", "h"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inDir", "=", 
   RowBox[{"FE", "<>", "\"\</blocks/h=\>\"", "<>", 
    RowBox[{"hStr", "[", 
     RowBox[{"[", "meshLevel", "]"}], "]"}], "<>", "\"\<_\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inDirC", "=", 
   RowBox[{"\"\<P1P1/blocks/h=\>\"", "<>", 
    RowBox[{"hStr", "[", 
     RowBox[{"[", "meshLevel", "]"}], "]"}], "<>", "\"\<_\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oDir", "=", 
   RowBox[{"FE", "<>", "\"\</h=\>\"", "<>", 
    RowBox[{"hStr", "[", 
     RowBox[{"[", "meshLevel", "]"}], "]"}], "<>", "\"\<_\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.756407895530698*^9, 3.756408069555463*^9}, {
   3.756414328126375*^9, 3.756414338479122*^9}, {3.7564146358924437`*^9, 
   3.756414654456026*^9}, {3.756414724628417*^9, 3.75641479152085*^9}, {
   3.7564148400217047`*^9, 3.756414904724207*^9}, {3.7564149791967*^9, 
   3.756414983134898*^9}, {3.756415042832946*^9, 3.756415058685153*^9}, {
   3.7564817170879993`*^9, 3.7564817542974033`*^9}, {3.756482194603101*^9, 
   3.756482205975625*^9}, {3.756482530099082*^9, 3.756482535828727*^9}, {
   3.756482594780425*^9, 3.756482631061256*^9}, {3.756484173318446*^9, 
   3.7564841734503736`*^9}, {3.756484245447363*^9, 3.7564842575589457`*^9}, 
   3.7564843248519793`*^9, {3.756487219211845*^9, 3.7564872193651123`*^9}, {
   3.75648757870693*^9, 3.7564875837304363`*^9}, {3.756487775737982*^9, 
   3.756487807402938*^9}, {3.7564878384679747`*^9, 3.7564878385766706`*^9}, {
   3.756487954234725*^9, 3.756487954389176*^9}, {3.756488040046674*^9, 
   3.7564880675021553`*^9}, {3.756489563335484*^9, 3.7564895788716*^9}, {
   3.756490497276458*^9, 3.756490497913088*^9}, {3.7564906406081667`*^9, 
   3.756490641218636*^9}, {3.756490739655985*^9, 3.7564907818995047`*^9}, {
   3.756490844245116*^9, 3.756490861588945*^9}, {3.75649810397635*^9, 
   3.756498104123567*^9}, {3.756648873889987*^9, 3.756648874043791*^9}, {
   3.756648947110805*^9, 3.756648954660109*^9}, {3.756827790941307*^9, 
   3.756827791443986*^9}, {3.756835783526105*^9, 3.756835804917295*^9}, {
   3.7568358470903873`*^9, 3.7568358716893663`*^9}, {3.7568362119143057`*^9, 
   3.756836212048018*^9}, {3.7568476860700397`*^9, 3.7568476899245243`*^9}, {
   3.7569101608903112`*^9, 3.756910161052451*^9}, {3.756910217953576*^9, 
   3.756910218106771*^9}, {3.75691043377806*^9, 3.756910433881543*^9}, {
   3.756910636790112*^9, 3.756910636969542*^9}, {3.7569107350316563`*^9, 
   3.75691073515723*^9}, {3.756911065137979*^9, 3.756911065282106*^9}, {
   3.756911776722705*^9, 3.756911781971765*^9}, {3.75691185831746*^9, 
   3.75691185855198*^9}, {3.7569119632311296`*^9, 3.756911964000025*^9}, {
   3.756912201147893*^9, 3.756912201360917*^9}, {3.7569125860186653`*^9, 
   3.7569125861344023`*^9}, {3.75691332001593*^9, 3.756913336765656*^9}, {
   3.7569134074033213`*^9, 3.7569134075566797`*^9}, {3.756913582902854*^9, 
   3.7569135830618467`*^9}, {3.756914246438919*^9, 3.75691425522895*^9}, {
   3.756915141774708*^9, 3.756915141940432*^9}, {3.7569152963878307`*^9, 
   3.7569152965319967`*^9}, {3.756915603028329*^9, 3.7569156031575823`*^9}, {
   3.7569158332877827`*^9, 3.756915859213709*^9}, {3.7569159511713467`*^9, 
   3.756915951287855*^9}, {3.756916460134927*^9, 3.75691648032717*^9}, {
   3.756916522024808*^9, 3.756916522724609*^9}, {3.756916926537431*^9, 
   3.756916926643955*^9}, {3.756917523353643*^9, 3.756917523816946*^9}, {
   3.756917789089161*^9, 3.7569177891985073`*^9}, {3.756917878042067*^9, 
   3.7569178783071117`*^9}, {3.75691843523322*^9, 3.756918435382889*^9}, {
   3.7569184997573013`*^9, 3.756918515390818*^9}, {3.756918545628004*^9, 
   3.756918545855571*^9}, {3.7569185990336123`*^9, 3.756918599162245*^9}, {
   3.756918631056377*^9, 3.756918631172125*^9}, {3.756918670863513*^9, 
   3.756918671074937*^9}, {3.756919531848247*^9, 3.756919531990407*^9}, {
   3.756919989954144*^9, 3.7569199900995913`*^9}, {3.756920044795782*^9, 
   3.7569200449073353`*^9}, {3.7569201477496233`*^9, 3.756920147880303*^9}, {
   3.756921279193605*^9, 3.756921279755991*^9}, {3.7569223298019743`*^9, 
   3.756922330001999*^9}, {3.756922434948648*^9, 3.7569224404836807`*^9}, {
   3.756948561621561*^9, 3.7569485835581427`*^9}, {3.756949731945499*^9, 
   3.756949732119488*^9}, {3.756956374628282*^9, 3.7569563748645897`*^9}, {
   3.756956601056553*^9, 3.7569566012960176`*^9}, {3.7569969446200447`*^9, 
   3.756996944997674*^9}, {3.757000278246161*^9, 3.757000287088623*^9}, {
   3.75700116015947*^9, 3.757001160285122*^9}, {3.7570011996474667`*^9, 
   3.757001218505919*^9}, {3.7570014217679663`*^9, 3.7570014304342117`*^9}, {
   3.757036371013056*^9, 3.757036371215865*^9}, {3.757053958742003*^9, 
   3.7570539590870533`*^9}, {3.7570543415506067`*^9, 3.757054350598617*^9}, {
   3.757054926513381*^9, 3.757054926824003*^9}, {3.757055149810871*^9, 
   3.757055149986084*^9}, {3.75709904157225*^9, 3.757099041704637*^9}, {
   3.7571080388597717`*^9, 3.757108038952256*^9}, {3.75710812303578*^9, 
   3.757108123247878*^9}, {3.75710822090886*^9, 3.757108221047858*^9}, {
   3.757108295387107*^9, 3.757108307161276*^9}, {3.757115088454582*^9, 
   3.7571150885178003`*^9}, {3.757119833589664*^9, 3.757119849663653*^9}, {
   3.7571220593481197`*^9, 3.757122059490116*^9}, {3.757124149668569*^9, 
   3.757124161470212*^9}, {3.757125169803935*^9, 3.7571251699605827`*^9}, {
   3.7571253560557947`*^9, 3.75712535619067*^9}, {3.757125783132227*^9, 
   3.7571257832832003`*^9}, {3.757148319685974*^9, 3.75714834553533*^9}, {
   3.7571807473645697`*^9, 3.757180747480473*^9}, {3.757183696675702*^9, 
   3.757183696805859*^9}, {3.7571874793915443`*^9, 3.757187479518589*^9}, {
   3.757254967066372*^9, 3.757254967188108*^9}, {3.757256326312736*^9, 
   3.757256326460493*^9}, {3.7572583311931133`*^9, 3.757258331308446*^9}, {
   3.757259174992227*^9, 3.757259175132115*^9}, {3.757331491309774*^9, 
   3.7573314914802723`*^9}, {3.757348445947686*^9, 3.757348446071197*^9}, {
   3.757441709901001*^9, 3.7574417101204767`*^9}, {3.757442076223587*^9, 
   3.757442076288773*^9}, {3.757442227053347*^9, 3.757442235329221*^9}, {
   3.7574427365515327`*^9, 3.757442736683646*^9}, {3.7574509406719418`*^9, 
   3.757450940870577*^9}, {3.757455430609726*^9, 3.7574554308098173`*^9}, {
   3.757455517612261*^9, 3.757455533274043*^9}, {3.757459164475973*^9, 
   3.757459164624292*^9}, {3.7574593793011*^9, 3.757459379901331*^9}, {
   3.757459504858759*^9, 3.7574595057542458`*^9}, {3.757459574418537*^9, 
   3.7574595745571747`*^9}, {3.757459702159677*^9, 3.757459702415557*^9}, {
   3.757460352088565*^9, 3.757460352230647*^9}, {3.757984893768733*^9, 
   3.7579848984359913`*^9}, {3.757985080089261*^9, 3.7579851252367477`*^9}, {
   3.7579852180013733`*^9, 3.757985218156721*^9}, {3.757985407305526*^9, 
   3.7579854074246607`*^9}, {3.757987285655129*^9, 3.75798733025345*^9}, {
   3.757987812985572*^9, 3.757987813131074*^9}, {3.757987964644058*^9, 
   3.757987964796093*^9}, {3.757988015373378*^9, 3.757988015510173*^9}, {
   3.757988572670993*^9, 3.7579885728261633`*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"53e9fa51-4fa1-451b-ba6e-c7a198bb6d9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDir", "<>", "\"\<A.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDir", "<>", "\"\<B.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "0"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDir", "<>", "\"\<M.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["n", "A"], "=", 
   RowBox[{"Length", "@", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["n", "S"], "=", 
   RowBox[{"Length", "@", 
    SubscriptBox["M", "0"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["C", "full"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDirC", "<>", "\"\<C_full.mtx\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["C", "n"], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"inDirC", "<>", "\"\<C_n.mtx\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.756407857635416*^9, 3.756407890801177*^9}, {
   3.756408072979414*^9, 3.756408080032325*^9}, {3.7564086238691587`*^9, 
   3.756408624783231*^9}, {3.756408689607057*^9, 3.756408692058215*^9}, {
   3.75640880851654*^9, 3.756408809632237*^9}, {3.756408863753731*^9, 
   3.756408880937994*^9}, {3.756409138258472*^9, 3.7564091426686583`*^9}, {
   3.7564137561044703`*^9, 3.7564138014243793`*^9}, {3.756481881218474*^9, 
   3.756481901645406*^9}, {3.756481996398695*^9, 3.7564819972479067`*^9}, {
   3.756482661569109*^9, 3.756482671160651*^9}, {3.756485445423623*^9, 
   3.7564854465600233`*^9}, {3.7566487790421267`*^9, 3.756648810939148*^9}, 
   3.756654132555187*^9, 3.756827782013549*^9, {3.7569484722980633`*^9, 
   3.7569485460762243`*^9}, {3.75744281093403*^9, 3.7574428121498613`*^9}, {
   3.7579849201534863`*^9, 3.757984920595707*^9}, {3.757985054603197*^9, 
   3.7579850549126177`*^9}, 3.757987844811551*^9},
 CellLabel->
  "In[292]:=",ExpressionUUID->"ec752cc5-e1cb-409c-b10f-43229f1b690c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", " ", "=", 
   SuperscriptBox["10.", 
    RowBox[{"-", "4"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[ScriptCapitalA]", "0"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", ",", 
        RowBox[{"Transpose", "@", "B"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"B", ",", "0."}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[ScriptCapitalM]", "0"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "\[Epsilon]"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["n", "A"], ",", 
            SubscriptBox["n", "A"]}], "}"}]}], "]"}], ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", 
        SubscriptBox["M", "0"]}], "}"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[ScriptCapitalA]", "full"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", ",", 
        RowBox[{"Transpose", "@", "B"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"B", ",", 
        RowBox[{"-", 
         SubscriptBox["C", "full"]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[ScriptCapitalM]", "full"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "\[Epsilon]"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["n", "A"], ",", 
            SubscriptBox["n", "A"]}], "}"}]}], "]"}], ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", 
        RowBox[{
         SubscriptBox["M", "0"], "+", 
         SubscriptBox["C", "full"]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[ScriptCapitalA]", "n"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", ",", 
        RowBox[{"Transpose", "@", "B"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"B", ",", 
        RowBox[{"-", 
         SubscriptBox["C", "n"]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[ScriptCapitalM]", "n"], "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "\[Epsilon]"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["n", "A"], ",", 
            SubscriptBox["n", "A"]}], "}"}]}], "]"}], ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", 
        RowBox[{
         SubscriptBox["M", "0"], "+", 
         SubscriptBox["C", "n"]}]}], "}"}]}], "}"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7568350646580067`*^9, 3.756835070144574*^9}, 
   3.756847593037788*^9, {3.756909906630948*^9, 3.756909911368636*^9}, {
   3.756916498917227*^9, 3.756916500180501*^9}, {3.756920140308655*^9, 
   3.756920140486198*^9}, {3.756920420317746*^9, 3.756920420572987*^9}, {
   3.7569204591669607`*^9, 3.756920459353539*^9}, {3.757051275028247*^9, 
   3.757051284052266*^9}, {3.757051334875292*^9, 3.757051341368593*^9}, {
   3.757053183135779*^9, 3.757053183323289*^9}, 3.757053318598653*^9, {
   3.757053548021133*^9, 3.757053548693124*^9}, {3.7571593181968117`*^9, 
   3.7571593730758266`*^9}, 3.757159581356203*^9, {3.75718959514454*^9, 
   3.7571895952548647`*^9}, {3.7572564311848993`*^9, 3.757256432292248*^9}, {
   3.757441690250886*^9, 3.757441690542801*^9}, 3.757987851780767*^9},
 CellLabel->
  "In[299]:=",ExpressionUUID->"f25fd86f-3926-47a6-bd9d-903b0d2d1fac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"format", "=", "\"\<mtx\>\""}], ";"}], "\n", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"oDir", "<>", "\"\<size.txt\>\""}], ",", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<nA\>\"", "\[Rule]", 
      SubscriptBox["n", "A"]}], ",", 
     RowBox[{"\"\<nS\>\"", "\[Rule]", 
      SubscriptBox["n", "S"]}]}], "|>"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"oDir", "<>", "\"\<A_block_0.\>\"", "<>", "format"}], ",", 
    SubscriptBox["\[ScriptCapitalA]", "0"]}], "]"}], "<>", "\"\< \>\"", "<>", 
  
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"oDir", "<>", "\"\<eps=\>\"", "<>", 
     RowBox[{"ToString", "@", "\[Epsilon]"}], "<>", "\"\<_M_block_0.\>\"", "<>",
      "format"}], ",", 
    SubscriptBox["\[ScriptCapitalM]", "0"]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"oDir", "<>", "\"\<A_block_full.\>\"", "<>", "format"}], ",", 
    SubscriptBox["\[ScriptCapitalA]", "full"]}], "]"}], "<>", "\"\< \>\"", "<>", 
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"oDir", "<>", "\"\<eps=\>\"", "<>", 
     RowBox[{"ToString", "@", "\[Epsilon]"}], "<>", "\"\<_M_block_full.\>\"", 
     "<>", "format"}], ",", 
    SubscriptBox["\[ScriptCapitalM]", "full"]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"oDir", "<>", "\"\<A_block_n.\>\"", "<>", "format"}], ",", 
    SubscriptBox["\[ScriptCapitalA]", "n"]}], "]"}], "<>", "\"\< \>\"", "<>", 
  
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"oDir", "<>", "\"\<eps=\>\"", "<>", 
     RowBox[{"ToString", "@", "\[Epsilon]"}], "<>", "\"\<_M_block_n.\>\"", "<>",
      "format"}], ",", 
    SubscriptBox["\[ScriptCapitalM]", "n"]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.757438535827757*^9, 3.7574385431005096`*^9}, {
   3.75743918929631*^9, 3.75743918985964*^9}, 3.757987859571849*^9},
 CellLabel->
  "In[306]:=",ExpressionUUID->"0f1aa91d-34e2-43d7-9651-9ab6246ed749"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["S", "0"], "=", 
   RowBox[{"B", ".", 
    RowBox[{"Inverse", "@", "A"}], ".", 
    RowBox[{"Transpose", "@", "B"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["S", "full"], "=", 
   RowBox[{
    SubscriptBox["S", "0"], "+", 
    SubscriptBox["C", "full"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["S", "n"], "=", 
   RowBox[{
    SubscriptBox["S", "0"], "+", 
    SubscriptBox["C", "n"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "full"], "=", 
   RowBox[{
    SubscriptBox["M", "0"], "+", 
    SubscriptBox["C", "full"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "n"], "=", 
   RowBox[{
    SubscriptBox["M", "0"], "+", 
    SubscriptBox["C", "n"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7574556361097507`*^9, 3.757455643555135*^9}, {
  3.757985288335371*^9, 3.7579853200853157`*^9}, {3.7579875751276693`*^9, 
  3.757987575424027*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"ba6aa0df-4e6a-471e-abf0-a71a736fa6fa"],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["S", "full"], ",", 
    SubscriptBox["M", "full"]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7579853291779003`*^9, 3.7579853437445383`*^9}, {
  3.7579875826295424`*^9, 3.7579875909043083`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"af1cd3ba-9c25-42d2-818c-113788554582"],

Cell[BoxData[{
 RowBox[{"lHonest", "=", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["S", "full"], ",", 
     SubscriptBox["M", "full"]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScientificForm", "[", 
    RowBox[{"#", ",", "4"}], "]"}], "&"}], "/@", 
  RowBox[{"Sort", "[", 
   RowBox[{"lHonest", ",", 
    RowBox[{
     RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"lHack", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalA]", "full"], ",", 
       SubscriptBox["\[ScriptCapitalM]", "full"]}], "}"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "A"], "+", "1"}], ";;"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScientificForm", "[", 
    RowBox[{"#", ",", "4"}], "]"}], "&"}], "/@", 
  RowBox[{"Sort", "[", 
   RowBox[{"lHack", ",", 
    RowBox[{
     RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.757985323400002*^9, 3.7579853239401493`*^9}, {
  3.757987571637291*^9, 
  3.7579875729805326`*^9}},ExpressionUUID->"492a6492-cf0d-4831-916a-\
af36d46e82a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Export ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "1b192425-bf6d-4d75-8158-85b62004c257"],
 " table"
}], "Section",
 CellChangeTimes->{{3.757160064728466*^9, 3.757160065849066*^9}, {
  3.757455653529909*^9, 
  3.757455662745658*^9}},ExpressionUUID->"5d44e64c-df91-4bf9-801e-\
1cf33479c78d"],

Cell[BoxData[
 RowBox[{"hStr", "=", 
  RowBox[{"hStr", "[", 
   RowBox[{"[", 
    RowBox[{";;", "4"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.757988170526718*^9, 3.757988178414464*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"7755c5a4-cf73-4f95-b08d-096246d5295e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s0", "=", 
   RowBox[{"sfull", "=", 
    RowBox[{"sn", "=", 
     RowBox[{"n", "=", 
      RowBox[{"<|", "|>"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"n", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "FE", "<>", "\"\</h=\>\"", "<>", "h", "<>", "\"\<_size.txt\>\""}], 
          "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"s0", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "FE", "<>", "\"\</h=\>\"", "<>", "h", "<>", 
           "\"\<_A_block_0.mtx.lambda.txt\>\""}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"sn", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "FE", "<>", "\"\</h=\>\"", "<>", "h", "<>", 
           "\"\<_A_block_n.mtx.lambda.txt\>\""}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"sfull", ",", 
       RowBox[{"h", "\[Rule]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"Import", "[", 
          RowBox[{
          "FE", "<>", "\"\</h=\>\"", "<>", "h", "<>", 
           "\"\<_A_block_full.mtx.lambda.txt\>\""}], "]"}]}]}]}], "]"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "hStr"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.757456588123664*^9, 3.757456653583621*^9}, {
   3.757456696308577*^9, 3.7574567368228607`*^9}, {3.757456797104134*^9, 
   3.75745694445763*^9}, {3.7574569756314793`*^9, 3.757456992843491*^9}, {
   3.757457306060063*^9, 3.757457316369774*^9}, {3.757457483133505*^9, 
   3.757457492793899*^9}, {3.7574587547604103`*^9, 3.757458810502556*^9}, {
   3.7574590663901463`*^9, 3.7574590680979967`*^9}, 3.757459347015596*^9},
 CellLabel->
  "In[274]:=",ExpressionUUID->"139a5aa6-8057-4992-a17c-9475701a6363"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<h\>\"", ",", "\"\<\!\(\*SubscriptBox[\(n\), \(A\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(n\), \(S\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", "SpanFromLeft", 
       ",", "\"\<\!\(\*SubscriptBox[\(S\), \(n\)]\)\>\"", ",", "SpanFromLeft",
        ",", "\"\<\!\(\*SubscriptBox[\(S\), \(full\)]\)\>\"", ",", 
       "SpanFromLeft"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "SpanFromAbove", ",", "SpanFromAbove", ",", "SpanFromAbove", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(min\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(min\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(min\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ScientificForm", "[", 
         RowBox[{
          RowBox[{"ToExpression", "@", "#"}], ",", "3"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nA\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nS\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"s0", "[", 
          RowBox[{"#", ",", "\"\<lambdas\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"sn", "[", 
          RowBox[{"#", ",", "\"\<lambdas\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"sfull", "[", 
          RowBox[{"#", ",", "\"\<lambdas\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "&"}], "/@", "hStr"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tableRes", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ScientificForm", "[", 
         RowBox[{
          RowBox[{"ToExpression", "@", "#"}], ",", "3"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nA\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"n", "[", 
         RowBox[{"#", ",", "\"\<nS\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"s0", "[", 
          RowBox[{"#", ",", "\"\<residuals\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"sn", "[", 
          RowBox[{"#", ",", "\"\<residuals\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScientificForm", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"sfull", "[", 
          RowBox[{"#", ",", "\"\<residuals\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "&"}], "/@", "hStr"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.756415221981977*^9, 3.756415359828733*^9}, {
   3.7564154642973557`*^9, 3.7564154748828173`*^9}, {3.75641559192651*^9, 
   3.7564156391710463`*^9}, {3.756415803136593*^9, 3.756415925465226*^9}, {
   3.756415961441599*^9, 3.75641596607924*^9}, {3.756416009932086*^9, 
   3.7564161342141047`*^9}, {3.7569481937410593`*^9, 3.756948215446056*^9}, {
   3.7569483264498672`*^9, 3.756948328737749*^9}, {3.756948633115903*^9, 
   3.756948699536316*^9}, {3.756949319451996*^9, 3.756949343816921*^9}, {
   3.756949551358749*^9, 3.7569495660601807`*^9}, {3.756949719760213*^9, 
   3.7569497210199003`*^9}, {3.756949833548538*^9, 3.756949853222731*^9}, {
   3.75711959835032*^9, 3.757119608755267*^9}, {3.757148472134547*^9, 
   3.757148472309092*^9}, {3.757148586904916*^9, 3.7571485870578947`*^9}, {
   3.7571486173029423`*^9, 3.7571486174039993`*^9}, {3.7574570466091557`*^9, 
   3.757457119199337*^9}, {3.757457509200075*^9, 3.757457567959278*^9}, {
   3.757458404218047*^9, 3.7574584098068647`*^9}, 3.757458724871483*^9, {
   3.7574588334754677`*^9, 3.757458949335189*^9}, {3.757459362105814*^9, 
   3.757459363498476*^9}, {3.7574610190983477`*^9, 3.7574610618600807`*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"1ab55286-a91d-4364-ad7a-868886db4119"],

Cell[BoxData[{
 RowBox[{"grid", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"header", ",", "table"}], "]"}], ",", 
    RowBox[{"Frame", "\[Rule]", "All"}], ",", 
    RowBox[{"Alignment", "\[Rule]", "Center"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{"header", ",", "tableRes"}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.756415110016934*^9, 3.756415112828258*^9}, {
  3.756415478474792*^9, 3.7564154929895277`*^9}, {3.756415575079176*^9, 
  3.756415585569605*^9}, {3.756416012269113*^9, 3.756416016623958*^9}, {
  3.756416175676708*^9, 3.756416183961246*^9}, {3.7569490700328197`*^9, 
  3.756949071626814*^9}, {3.756949901426509*^9, 3.756949913776581*^9}, {
  3.757461075685412*^9, 3.757461080979609*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"9f4da7c1-1ed1-4f5b-8009-b43b21d3a419"],

Cell[BoxData[
 RowBox[{"<<", " ", "\"\<TeXTableForm.m\>\""}]], "Input",
 CellChangeTimes->{{3.7569504032804947`*^9, 3.756950404080031*^9}, {
  3.7569504383642597`*^9, 3.756950445149898*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[281]:=",ExpressionUUID->"b1bc8da2-3577-4048-8ddb-d316fabb8dc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TeXTableForm", "[", 
   RowBox[{"table", ",", "1", ",", 
    RowBox[{"\"\<LaTeX/\>\"", "<>", "FE", "<>", "\"\<_table.tex\>\""}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7569511669375257`*^9, 3.756951204427828*^9}, {
   3.756951302047423*^9, 3.7569513828009357`*^9}, {3.757119480155694*^9, 
   3.7571194865393267`*^9}, 3.7571196217335176`*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"031db65d-2951-4047-9f06-f10b474e0608"],

Cell[BoxData[
 RowBox[{"tex", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
      "\"\<\\\\\\\\ \\hline\>\""}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"\"\<LaTeX/\>\"", "<>", "FE", "<>", "\"\<_table.tex\>\""}], 
      ",", "\"\<Table\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.756952648255701*^9, 3.75695279004072*^9}, {
   3.7569531625351267`*^9, 3.756953251793041*^9}, {3.756953295605999*^9, 
   3.756953379971849*^9}, {3.757119645572233*^9, 3.75711964678327*^9}, 
   3.757148497936266*^9},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[283]:=",ExpressionUUID->"772672a6-1805-42f9-9868-5bfe028e5465"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<LaTeX/\>\"", "<>", "FE", "<>", "\"\<_table.tex\>\""}], ",", 
   "tex", ",", "\"\<Table\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7569513875442266`*^9, 3.756951432344377*^9}, {
  3.75695147308438*^9, 3.756951567887931*^9}, {3.756951602522017*^9, 
  3.7569516633530197`*^9}, {3.756951717731988*^9, 3.756951754218623*^9}, {
  3.7569518244307537`*^9, 3.7569519100906277`*^9}, {3.756951966086198*^9, 
  3.7569519705791597`*^9}, {3.756952075204831*^9, 3.7569520767605057`*^9}, {
  3.756952109151977*^9, 3.756952110876313*^9}, {3.756952276199881*^9, 
  3.756952302563987*^9}, {3.7569533045307207`*^9, 3.7569533110890636`*^9}, {
  3.757148603232441*^9, 3.75714860432613*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"cb4f9bb5-e552-4b79-9ae0-2f02a2a9d7d0"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1853, 1025},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 189, 3, 98, "Title",ExpressionUUID->"6193ad47-c70e-4e74-9d60-feaf6a874117"],
Cell[CellGroupData[{
Cell[794, 29, 197, 3, 68, "Section",ExpressionUUID->"3608f823-93f6-4ce7-a043-78027be50adb"],
Cell[994, 34, 265, 5, 31, "Input",ExpressionUUID->"4af98514-6d1e-47d4-ac70-2586f4a120fa"],
Cell[1262, 41, 7641, 121, 170, "Input",ExpressionUUID->"53e9fa51-4fa1-451b-ba6e-c7a198bb6d9a"],
Cell[8906, 164, 2082, 51, 170, "Input",ExpressionUUID->"ec752cc5-e1cb-409c-b10f-43229f1b690c"],
Cell[10991, 217, 4377, 129, 172, "Input",ExpressionUUID->"f25fd86f-3926-47a6-bd9d-903b0d2d1fac"],
Cell[15371, 348, 2014, 51, 124, "Input",ExpressionUUID->"0f1aa91d-34e2-43d7-9651-9ab6246ed749"],
Cell[17388, 401, 1107, 35, 124, "Input",ExpressionUUID->"ba6aa0df-4e6a-471e-abf0-a71a736fa6fa"],
Cell[18498, 438, 371, 9, 31, "Input",ExpressionUUID->"af1cd3ba-9c25-42d2-818c-113788554582"],
Cell[18872, 449, 1240, 39, 101, "Input",ExpressionUUID->"492a6492-cf0d-4831-916a-af36d46e82a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20149, 493, 642, 21, 68, "Section",ExpressionUUID->"5d44e64c-df91-4bf9-801e-1cf33479c78d"],
Cell[20794, 516, 277, 7, 31, "Input",ExpressionUUID->"7755c5a4-cf73-4f95-b08d-096246d5295e"],
Cell[21074, 525, 2213, 55, 170, "Input",ExpressionUUID->"139a5aa6-8057-4992-a17c-9475701a6363"],
Cell[23290, 582, 5124, 118, 400, "Input",ExpressionUUID->"1ab55286-a91d-4364-ad7a-868886db4119"],
Cell[28417, 702, 1001, 22, 55, "Input",ExpressionUUID->"9f4da7c1-1ed1-4f5b-8009-b43b21d3a419"],
Cell[29421, 726, 303, 6, 31, "Input",ExpressionUUID->"b1bc8da2-3577-4048-8ddb-d316fabb8dc5"],
Cell[29727, 734, 472, 10, 31, "Input",ExpressionUUID->"031db65d-2951-4047-9f06-f10b474e0608"],
Cell[30202, 746, 899, 25, 31, "Input",ExpressionUUID->"772672a6-1805-42f9-9868-5bfe028e5465"],
Cell[31104, 773, 821, 14, 31, "Input",ExpressionUUID->"cb4f9bb5-e552-4b79-9ae0-2f02a2a9d7d0"]
}, Open  ]]
}, Open  ]]
}
]
*)

