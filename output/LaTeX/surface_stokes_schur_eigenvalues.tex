\documentclass[12pt]{article}

\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsthm}

\usepackage[dvipsnames, table]{xcolor}
% links
\usepackage{hyperref}
\hypersetup{
	colorlinks,
	linkcolor={Red!90!black},
	citecolor={Red!90!black},
	urlcolor={Red}
}

\usepackage{geometry}
\newgeometry{
	left=1cm, right=1cm, top=1cm, bottom=1cm,
	includefoot, heightrounded
}

\usepackage[parfill]{parskip} % https://tex.stackexchange.com/a/16703/135296

% sub figures / grids of pictures
\usepackage{subcaption}
\usepackage{graphicx}
\graphicspath{{img/}} % includegraphics path
\newcommand{\includegraphicsw}[2][1.]{\includegraphics[width=#1\linewidth]{#2}}
\newcommand{\svginput}[1]{\input{img/#1}} % pdf_tex path
\newcommand{\svginputw}[2][\linewidth]{\def\svgwidth{#1}\input{img/#2}} % pdf_tex path

% tables
\usepackage{multirow}
\usepackage{hhline}

% bold for everything
\usepackage{bm}
\newcommand{\vect}[1]{\boldsymbol{\mathbf{#1}}}

% differentials
\newcommand*\diff{\mathop{}\!\mathrm{d}}
\newcommand*\Diff[1]{\mathop{}\!\mathrm{d^#1}}

\DeclareMathOperator{\Div}{div}
\newcommand{\sphere}{{\Gamma_{\text{sph}}}}
\newcommand{\tor}{{\Gamma_{\text{tor}}}}

\title{Some computational results for generalized pressure Schur complement eigenvalues of the surface Stokes problem}
\author{
	Alexander Zhiliakov\thanks{Department of Mathematics, University of Houston, Houston, Texas 77204 (alex@math.uh.edu).}
}

\begin{document}
	
\maketitle
	
\let\oldtabular\tabular
\renewcommand{\tabular}[1][1.5]{\def\arraystretch{#1}\oldtabular}

\section{Bilinear forms and matrices}

We set $n_{\vect A}$ to be the number of velocity d.o.f. and $n_{\vect S}$ to be the number of pressure d.o.f. Vector stiffness, divergence, pressure mass, normal stabilization, and full stabilization matrices resulting from Trace\,FEM discretization of the surface Stokes problem~\cite{surfstokes} are defined via
\begin{align}\begin{split}
	\langle \vect A\,\bar{\vect u}, \bar{\vect v} \rangle &= 
		\int_{\Gamma} \big( E_s(\vect u) : E_s(\vect v) + \vect u\cdot\vect v + \tau\,u_N\,v_N \big) \diff{s} + 
		\rho_u \int_{\Omega_h^{\Gamma}} ([\nabla\vect u]\,\hat{\vect n})\cdot([\nabla\vect v]\,\hat{\vect n}) \diff{\vect x}, \quad \vect A \in \mathbb R^{n_{\vect A} \times n_{\vect A}},\\
	\langle \vect B\,\bar{\vect u}, \bar{\vect q} \rangle &= 
		-\int_{\Gamma} q\,\Div_{\Gamma} \vect u \diff{s}, \quad \vect B \in \mathbb R^{n_{\vect S} \times n_{\vect A}},\\
	\langle \vect M_0\,\bar{\vect p}, \bar{\vect q} \rangle &=
		\int_{\Gamma} p\,q \diff{s}, \quad \vect M_0 \in \mathbb R^{n_{\vect S} \times n_{\vect S}},\\
	\langle \vect C_n\,\bar{\vect p}, \bar{\vect q} \rangle &=
		\rho_p \int_{\Omega^{\Gamma}_h} \frac{\partial p}{\partial\hat{\vect n}} \frac{\partial q}{\partial\hat{\vect n}} \diff{\vect x}, \quad \vect C_n \in \mathbb R^{n_{\vect S} \times n_{\vect S}},\\
	\langle \vect C_{\text{full}}\,\bar{\vect p}, \bar{\vect q} \rangle &=
		\rho_p \int_{\Omega^{\Gamma}_h} \nabla p \cdot \nabla q \diff{\vect x}, \quad \vect C_{\text{full}} \in \mathbb R^{n_{\vect S} \times n_{\vect S}},		 
\end{split}\end{align}
respectively. Here~$\bar{\vect u}$ denotes a vector of d.o.f. corresponding to a FE interpolant~$\vect u$ (analogously for $\bar{\vect p}$ and $p$). Mesh-dependent parameters are set as
\begin{equation}
	\tau = h^{-2}, \quad \rho_u = \rho_p = h,
\end{equation}
and $h$ is the mesh size of~$\Omega^{\Gamma}_h$. $\Gamma$ is chosen either as the unit sphere or torus, $\Gamma = \sphere$ or $\Gamma = \tor$ (see Figure~\ref{fig:gamma}).

We also define matrices 
\begin{align}\begin{split}
	\vect C_0 &\coloneqq \vect 0,\\
	\vect M_n &\coloneqq \vect M_0 + \vect C_n,\\
	\vect M_{\text{full}} &\coloneqq \vect M_0 + \vect C_{\text{full}}.
\end{split}\end{align}
We are interested in (generalized) extreme eigenvalues of the pressure Schur complement matrices
\begin{align}\label{schur}\begin{split}
	\vect S_0 &\coloneqq \vect B\,\vect A^{-1}\,\vect B^{T},\\
	\vect S_n &\coloneqq \vect S_0 + \vect C_n,\\
	\vect S_{\text{full}} &\coloneqq \vect S_0 + \vect C_{\text{full}},
\end{split}\end{align}
i.e. in solving
\begin{equation}\label{problem}
	\vect S_\star\,\vect x = \lambda\,\vect M_\star\,\vect x,
\end{equation}
where ``$\star$'' stands for ``$0$,'' ``$n$,'' or ``full.'' We denote by~$0 = \lambda_1 < \lambda_2 \le \dots \le \lambda_{n_{\vect S}} = O(1)$ the spectrum of~\eqref{problem}.

\section{Solution description}

Computing $\vect A^{-1}$ in~\eqref{schur} becomes troublesome already for $h = 5.21\times10^{-2}$ ($n_{\vect A} = 32736$ for $\vect u \in \vect P_1$ FE space): although $\vect A$ is sparse, $\vect A^{-1}$ is dense and consumes 8.5+ GB in double-precision arithmetic. A quick research \href{https://mathematica.stackexchange.com/questions/189620/matrix-free-arnoldi-method-for-eigensystems}{showed} that \texttt{Mathematica} has no built-in matrix-free eigenvalue routines. \texttt{Intel MKL}'s FEAST algorithm for computing (generalized) eigenvalues in an interval \href{https://software.intel.com/sites/default/files/mkl-2019-developer-reference-c.pdf#_OPENTOPIC_TOC_PROCESSING_d62e853651}{is suitable for matrix-free implementations}; however, it requires some expensive operations to be implemented (e.g. matrix-matrix multiplications $\vect S_\star\,\vect X \leftarrow \vect Y$, $\vect M_\star\,\vect X \leftarrow \vect Y$ and approximating the action of inverses in the form $(\sigma\,\vect M_\star - \vect S_\star)^{-1}\,\vect x \leftarrow \vect y$).

Taking this into account, instead of~\eqref{problem} we consider a perturbed\footnotemark{} problem
\begin{equation}\label{problem_pert}
	\underbrace{\begin{bmatrix}
		\vect A & \vect B^T \\
		\vect B & \vect C_\star \\
	\end{bmatrix}}_{\mathcal A_\star \coloneqq}
	\begin{bmatrix}
		\vect u \\
		\vect p
	\end{bmatrix}
	=
	\mu
	\underbrace{\begin{bmatrix}
		\epsilon\,\vect A & \\
		& \vect M_\star
	\end{bmatrix}}_{\mathcal M^\epsilon_\star \coloneqq}
	\begin{bmatrix}
		\vect u \\
		\vect p
	\end{bmatrix}
\end{equation}
with $0 < \epsilon \ll 1$. For $\mathcal A_0$ and $\mathcal M^\epsilon_0$ we have
\begin{equation}
	\mu = -\lambda + o(1)\quad\text{or}\quad\epsilon^{-1} + \lambda + o(1),\qquad\epsilon \rightarrow 0.
\end{equation}
This makes it easy to pick only ``correct'' eigenvalues. To make sure that results are consistent we solved~\eqref{problem_pert} for~$\epsilon = 10^{-5}$ and~$\epsilon = 10^{-6}$.

\footnotetext{The majority of generalized eigenvalue solvers require left-hand-side matrix to be Hermitian and right-hand-side matrix to be Hermitian \textbf{positive definite}; that's why we need to introduce $\epsilon > 0$.}     
	
\begin{figure}[h]
	\centering
	\begin{subfigure}{.33\linewidth}
		\centering
		\includegraphicsw{lvl1.png}
		\caption{$h = 8.33\times10^{-1}$}
	\end{subfigure}%
	\begin{subfigure}{.33\linewidth}
		\centering
		\includegraphicsw{lvl2.png}
		\caption{$h = 4.17\times10^{-1}$}
	\end{subfigure}%
	\begin{subfigure}{.33\linewidth}
		\centering
		\includegraphicsw{lvl3.png}
		\caption{$h = 2.08\times10^{-1}$}
	\end{subfigure}
	\par
	\begin{subfigure}{.33\linewidth}
		\centering
		\includegraphicsw{tor_lvl3.png}
		\caption{$h = 2.08\times10^{-1}$}
	\end{subfigure}%
	\begin{subfigure}{.33\linewidth}
		\centering
		\includegraphicsw{tor_lvl4.png}
		\caption{$h = 1.04\times10^{-1}$}
	\end{subfigure}%
	\begin{subfigure}{.33\linewidth}
		\centering
		\includegraphicsw{tor_lvl5.png}
		\caption{$h = 5.21\times10^{-2}$}
	\end{subfigure}
	\caption{First three mesh levels for~$\sphere$ (top) and $\tor$ (bottom)}
	\label{fig:gamma}		
\end{figure}

\clearpage

\begin{table}[h!]
	\centering
	\caption{$\vect P_1$\,--\,$P_1$ for $\sphere$} 
	\label{tab:p1p1}
	\small
	\begin{tabular}[1.3]{|c|c|c|c|c|c|c|c|c|}
		\hline
		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
		\cline{4-9}
		& & & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ \\ 
		\hline
		\input{sphere_2_P1P1_table.tex}
%		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
%		\cline{4-9}
%		& & & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ \\ 
%		\hline
%		\input{sphere_2_P1P1_res_table.tex}
	\end{tabular}
\end{table}
\begin{table}[h!]
	\centering
	\caption{$\vect P_1$\,--\,$P_1$ for $\tor$} 
	\label{tab:p1p1_tor}
	\small
	\begin{tabular}[1.3]{|c|c|c|c|c|c|c|c|c|}
		\hline
		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
		\cline{4-9}
		& & & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ \\ 
		\hline
		\input{torus_P1P1_table.tex}
		%		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
		%		\cline{4-9}
		%		& & & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ \\ 
		%		\hline
		%		\input{torus_P1P1_res_table.tex}
	\end{tabular}
\end{table}
\vfill
\begin{figure}[h]
	\centering
	\begin{subfigure}{.49\linewidth}
		\centering
		\includegraphicsw{sphere_2_P1P1.png}
		\caption{$\vect P_1$\,--\,$P_1$ for $\sphere$}
	\end{subfigure}%
	\hfill
	\begin{subfigure}{.49\linewidth}
		\centering
		\includegraphicsw{torus_P1P1.png}
		\caption{$\vect P_1$\,--\,$P_1$ for $\tor$}
	\end{subfigure}
\end{figure}
\vfill

\clearpage

\begin{table}[h!]
	\centering
	\caption{$\vect P_2$\,--\,$P_1$ for $\sphere$} 
	\label{tab:p2p1}
	\small
	\begin{tabular}[1.3]{|c|c|c|c|c|c|c|c|c|}
		\hline
		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
		\cline{4-9}
		& & & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ \\ 
		\hline
		\input{sphere_2_P2P1_table.tex}
%		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
%		\cline{4-9}
%		& & & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ \\ 
%		\hline
%		\input{sphere_2_P2P1_res_table.tex}
	\end{tabular}
\end{table}
\begin{table}[h!]
	\centering
	\caption{$\vect P_2$\,--\,$P_1$ for $\tor$} 
	\label{tab:p2p1_tor}
	\small
	\begin{tabular}[1.3]{|c|c|c|c|c|c|c|c|c|}
		\hline
		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
		\cline{4-9}
		& & & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ & $\lambda_2$ & $\lambda_{n_{\vect S}}$ \\ 
		\hline
		\input{torus_P2P1_table.tex}
%		\multirow{2}{*}{$h$} & \multirow{2}{*}{$n_{\vect A}$} & \multirow{2}{*}{$n_{\vect S}$} & \multicolumn{2}{c|}{$\vect S_0$} & \multicolumn{2}{c|}{$\vect S_n$} & \multicolumn{2}{c|}{$\vect S_{\text{full}}$} \\ 
%		\cline{4-9}
%		& & & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ & $r_2$ & $r_{n_{\vect S}}$ \\ 
%		\hline
%		\input{torus_P2P1_res_table.tex}
	\end{tabular}
\end{table}
\vfill
\begin{figure}[h]
	\centering
	\begin{subfigure}{.49\linewidth}
		\centering
		\includegraphicsw{sphere_2_P2P1.png}
		\caption{$\vect P_2$\,--\,$P_1$ for $\sphere$}
	\end{subfigure}%
	\hfill
	\begin{subfigure}{.49\linewidth}
		\centering
		\includegraphicsw{torus_P2P1.png}
		\caption{$\vect P_2$\,--\,$P_1$ for $\tor$}
	\end{subfigure}	
\end{figure}
\vfill

\clearpage

\bibliographystyle{plain}
\bibliography{bibl}

\end{document}